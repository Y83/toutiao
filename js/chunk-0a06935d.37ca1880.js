(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a06935d"],{"9ed6":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login-container"},[n("van-nav-bar",{staticClass:"page-nav-bar",attrs:{"left-arrow":"",title:"登录"},on:{"click-left":function(e){return t.$router.push(t.$route.query.redirect||"/")}}}),n("van-form",{ref:"loginForm",on:{submit:t.onSubmit}},[n("van-field",{attrs:{name:"mobile",placeholder:"请输入手机号",rules:t.userFormRules.mobile,type:"number",maxlength:"11"},model:{value:t.user.mobile,callback:function(e){t.$set(t.user,"mobile",e)},expression:"user.mobile"}},[n("i",{staticClass:"iconfont icon_shouji",attrs:{slot:"left-icon"},slot:"left-icon"})]),n("van-field",{attrs:{name:"code",placeholder:"请输入验证码",rules:t.userFormRules.code,type:"number",maxlength:"6"},scopedSlots:t._u([{key:"button",fn:function(){return[t.isCountDownShow?n("van-count-down",{attrs:{time:6e4,format:"ss s"},on:{finish:function(e){t.isCountDownShow=!1}}}):n("van-button",{staticClass:"send-sms-btn",attrs:{round:"",size:"small",type:"default","native-type":"button"},on:{click:t.onSendSms}},[t._v("发送验证码")])]},proxy:!0}]),model:{value:t.user.code,callback:function(e){t.$set(t.user,"code",e)},expression:"user.code"}},[n("i",{staticClass:"iconfont icon_yanzhengma",attrs:{slot:"left-icon"},slot:"left-icon"})]),n("div",{staticClass:"login-btn-wrap"},[n("van-button",{staticClass:"login-btn",attrs:{block:"",type:"info","native-type":"submit"}},[t._v(" 登录 ")])],1)],1)],1)},o=[],a=(n("96cf"),n("1da1")),u=n("c24f"),s={name:"LoginPage",data:function(){return{user:{mobile:"",code:""},userFormRules:{mobile:[{required:!0,message:"手机号不能为空"},{pattern:/^1[3|5|7|8]\d{9}$/,message:"手机号格式错误"}],code:[{required:!0,message:"验证码不能为空"},{pattern:/^\d{6}$/,message:"验证码格式错误"}]},isCountDownShow:!1}},methods:{onSubmit:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.user,t.$toast.loading({message:"登录中...",forbidClick:!0,duration:0}),e.prev=2,e.next=5,Object(u["i"])(n);case 5:r=e.sent,o=r.data,t.$store.commit("setUser",o.data),t.$toast.success("登录成功"),t.$router.push(t.$route.query.redirect||"/"),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),400===e.t0.response.status?t.$toast.fail("手机号或验证码错误"):t.$toast.fail("登录失败，请稍后重试");case 15:case"end":return e.stop()}}),e,null,[[2,12]])})))()},onSendSms:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$refs.loginForm.validate("mobile");case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e["catch"](0),e.abrupt("return",console.log("验证失败",e.t0));case 8:return t.isCountDownShow=!0,e.prev=9,e.next=12,Object(u["j"])(t.user.mobile);case 12:t.$toast("发送成功"),e.next=19;break;case 15:e.prev=15,e.t1=e["catch"](9),t.isCountDownShow=!1,429===e.t1.response.status?t.$toast("发送太频繁了，请稍后重试"):t.$toast("发送失败，请稍后重试");case 19:case"end":return e.stop()}}),e,null,[[0,5],[9,15]])})))()}}},i=s,c=(n("f61a"),n("2877")),l=Object(c["a"])(i,r,o,!1,null,"4038151e",null);e["default"]=l.exports},b051:function(t,e,n){},c24f:function(t,e,n){"use strict";n.d(e,"i",(function(){return o})),n.d(e,"j",(function(){return a})),n.d(e,"g",(function(){return u})),n.d(e,"f",(function(){return s})),n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"l",(function(){return d})),n.d(e,"k",(function(){return f})),n.d(e,"e",(function(){return p})),n.d(e,"d",(function(){return m})),n.d(e,"c",(function(){return b}));n("d3b7"),n("25f0");var r=n("b775"),o=function(t){return Object(r["a"])({method:"POST",url:"/app/v1_0/authorizations",data:t})},a=function(t){return Object(r["a"])({method:"GET",url:"/app/v1_0/sms/codes/"+t})},u=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user"})},s=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/channels"})},i=function(t){return Object(r["a"])({method:"POST",url:"/app/v1_0/user/followings",data:{target:t}})},c=function(t){return Object(r["a"])({method:"DELETE",url:"/app/v1_0/user/followings/"+t})},l=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/profile"})},d=function(t){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:t})};function f(t){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:t})}var p=function(t){return Object(r["a"])({method:"GET",url:"/app/v1_0/users/".concat(t)})};function m(t,e){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/followings",params:e,data:{target:t.toString()}})}function b(t,e){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/followers",params:e,data:{target:t.toString()}})}},f61a:function(t,e,n){"use strict";n("b051")}}]);
//# sourceMappingURL=chunk-0a06935d.37ca1880.js.map